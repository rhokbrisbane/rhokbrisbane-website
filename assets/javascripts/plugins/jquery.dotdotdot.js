/*  
 *  jQuery dotdotdot 1.5.10
 *  
 *  Copyright (c) 2013 Fred Heusschen
 *  www.frebsite.nl
 *
 *  Plugin website:
 *  dotdotdot.frebsite.nl
 *
 *  Dual licensed under the MIT and GPL licenses.
 *  http://en.wikipedia.org/wiki/MIT_License
 *  http://en.wikipedia.org/wiki/GNU_General_Public_License
 */
!function(t){function e(t,e,n){var o=t.children(),i=!1;t.empty();for(var d=0,a=o.length;a>d;d++){var l=o.eq(d);if(t.append(l),n&&t.append(n),r(t,e)){l.remove(),i=!0;break}n&&n.remove()}return i}function n(e,i,d,a,l){var u=e.contents(),f=!1;e.empty();for(var c="table, thead, tbody, tfoot, tr, col, colgroup, object, embed, param, ol, ul, dl, select, optgroup, option, textarea, script, style",s=0,p=u.length;p>s&&!f;s++){var h=u[s],g=t(h);"undefined"!=typeof h&&(e.append(g),l&&e[e.is(c)?"after":"append"](l),3==h.nodeType?r(d,a)&&(f=o(g,i,d,a,l)):f=n(g,i,d,a,l),f||l&&l.remove())}return f}function o(t,e,n,d,u){var f=!1,c=t[0];if("undefined"==typeof c)return!1;for(var s=l(c),p=-1!==s.indexOf(" ")?" ":"\u3000",h="letter"==d.wrap?"":p,g=s.split(h),v=-1,w=-1,y=0,m=g.length-1;m>=y;){var b=Math.floor((y+m)/2);if(b==w)break;w=b,a(c,g.slice(0,w+1).join(h)+d.ellipsis),r(n,d)?m=w:(v=w,y=w)}if(-1==v||1==g.length&&0==g[0].length){var x=t.parent();t.remove();var T=u?u.length:0;if(x.contents().size()>T){var C=x.contents().eq(-1-T);f=o(C,e,n,d,u)}else{var I=x.prev(),c=I.contents().eq(-1)[0];if("undefined"!=typeof c){var s=i(l(c),d);a(c,s),u&&I.append(u),x.remove(),f=!0}}}else s=i(g.slice(0,v+1).join(h),d),f=!0,a(c,s);return f}function r(t,e){return t.innerHeight()>e.maxHeight}function i(e,n){for(;t.inArray(e.slice(-1),n.lastCharacter.remove)>-1;)e=e.slice(0,-1);return t.inArray(e.slice(-1),n.lastCharacter.noEllipsis)<0&&(e+=n.ellipsis),e}function d(t){return{width:t.innerWidth(),height:t.innerHeight()}}function a(t,e){t.innerText?t.innerText=e:t.nodeValue?t.nodeValue=e:t.textContent&&(t.textContent=e)}function l(t){return t.innerText?t.innerText:t.nodeValue?t.nodeValue:t.textContent?t.textContent:""}function u(e,n){return"undefined"==typeof e?!1:e?"string"==typeof e?(e=t(e,n),e.length?e:!1):"object"==typeof e?"undefined"==typeof e.jquery?!1:e:!1:!1}function f(t){for(var e=t.innerHeight(),n=["paddingTop","paddingBottom"],o=0,r=n.length;r>o;o++){var i=parseInt(t.css(n[o]),10);isNaN(i)&&(i=0),e-=i}return e}function c(t,e){return t?(e="string"==typeof e?"dotdotdot: "+e:["dotdotdot:",e],"undefined"!=typeof window.console&&"undefined"!=typeof window.console.log&&window.console.log(e),!1):!1}if(!t.fn.dotdotdot){t.fn.dotdotdot=function(o){if(0==this.length)return o&&o.debug===!1||c(!0,'No element found for "'+this.selector+'".'),this;if(this.length>1)return this.each(function(){t(this).dotdotdot(o)});var i=this;i.data("dotdotdot")&&i.trigger("destroy.dot"),i.data("dotdotdot-style",i.attr("style")),i.css("word-wrap","break-word"),i.bind_events=function(){return i.bind("update.dot",function(o,d){o.preventDefault(),o.stopPropagation(),l.maxHeight="number"==typeof l.height?l.height:f(i),l.maxHeight+=l.tolerance,"undefined"!=typeof d&&(("string"==typeof d||d instanceof HTMLElement)&&(d=t("<div />").append(d).contents()),d instanceof t&&(a=d)),v=i.wrapInner('<div class="dotdotdot" />').children(),v.empty().append(a.clone(!0)).css({height:"auto",width:"auto",border:"none",padding:0,margin:0});var u=!1,c=!1;return p.afterElement&&(u=p.afterElement.clone(!0),p.afterElement.remove()),r(v,l)&&(c="children"==l.wrap?e(v,l,u):n(v,i,v,l,u)),v.replaceWith(v.contents()),v=null,t.isFunction(l.callback)&&l.callback.call(i[0],c,a),p.isTruncated=c,c}).bind("isTruncated.dot",function(t,e){return t.preventDefault(),t.stopPropagation(),"function"==typeof e&&e.call(i[0],p.isTruncated),p.isTruncated}).bind("originalContent.dot",function(t,e){return t.preventDefault(),t.stopPropagation(),"function"==typeof e&&e.call(i[0],a),a}).bind("destroy.dot",function(t){t.preventDefault(),t.stopPropagation(),i.unwatch().unbind_events().empty().append(a).attr("style",i.data("dotdotdot-style")).data("dotdotdot",!1)}),i},i.unbind_events=function(){return i.unbind(".dot"),i},i.watch=function(){if(i.unwatch(),"window"==l.watch){var e=t(window),n=e.width(),o=e.height();e.bind("resize.dot"+p.dotId,function(){n==e.width()&&o==e.height()&&l.windowResizeFix||(n=e.width(),o=e.height(),g&&clearInterval(g),g=setTimeout(function(){i.trigger("update.dot")},10))})}else h=d(i),g=setInterval(function(){var t=d(i);(h.width!=t.width||h.height!=t.height)&&(i.trigger("update.dot"),h=d(i))},100);return i},i.unwatch=function(){return t(window).unbind("resize.dot"+p.dotId),g&&clearInterval(g),i};var a=i.contents(),l=t.extend(!0,{},t.fn.dotdotdot.defaults,o),p={},h={},g=null,v=null;return p.afterElement=u(l.after,i),p.isTruncated=!1,p.dotId=s++,i.data("dotdotdot",!0).bind_events().trigger("update.dot"),l.watch&&i.watch(),i},t.fn.dotdotdot.defaults={ellipsis:"... ",wrap:"word",lastCharacter:{remove:[" ","\u3000",",",";",".","!","?"],noEllipsis:[]},tolerance:0,callback:null,after:null,height:null,watch:!1,windowResizeFix:!0,debug:!1};var s=1,p=t.fn.html;t.fn.html=function(t){return"undefined"!=typeof t?this.data("dotdotdot")&&"function"!=typeof t?this.trigger("update",[t]):p.call(this,t):p.call(this)};var h=t.fn.text;t.fn.text=function(e){if("undefined"!=typeof e){if(this.data("dotdotdot")){var n=t("<div />");return n.text(e),e=n.html(),n.remove(),this.trigger("update",[e])}return h.call(this,e)}return h.call(this)}}}(jQuery);